<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>snmpCG</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Loading Bootstrap -->
    <link href="css/vendor/bootstrap.min.css" rel="stylesheet">

    <!-- Loading Flat UI -->
    <link href="css/flat-ui.min.css" rel="stylesheet">

    <link rel="shortcut icon" href="img/favicon.ico">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements. All other JS at the end of file. -->
    <!--[if lt IE 9]>
      <script src="js/vendor/html5shiv.js"></script>
      <script src="js/vendor/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <nav class="navbar navbar-default">
      <div class="container">
        <div class="navbar-header">
          <a class="navbar-brand" href="#">
            <img src="img/small_logo.png" width="35"  height="30" alt="snmpCG">
          </a>
        </div>
        <ul class="nav navbar-nav">
          <li><a href="index.html">Sources</a></li>
          <li><a href="stats.html">Stats</a></li>
          <li><a href="search.html">Bulk search</a></li>
        </ul>
      </div>
    </nav>
    <div class="container">
        <h3><span id="ip_span" class="label label-default"></span></h3>
        <table id="tbl_data" class="table table-condensed">
          <thead>
            <tr>
              <th>IfDescr</th>
              <th>IfInOctets</th>
              <th>IfOutOctets</th>
              <th>PollTime</th>
              <th>SysUpTime</th>
            </tr>
          </thead>
          <tbody>
          </tbody>  
        </table>
    </div>
    <!-- /.container -->


    <!-- jQuery (necessary for Flat UI's JavaScript plugins) -->
    <script src="js/vendor/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/vendor/video.js"></script>
    <script src="js/flat-ui.min.js"></script>
    <script>
        function getUrlParameter(sParam) {
            var sPageURL = window.location.search.substring(1);
            var sURLVariables = sPageURL.split('&');
            for (var i = 0; i < sURLVariables.length; i++) {
                var sParameterName = sURLVariables[i].split('=');
                if (sParameterName[0] == sParam) {
                    return sParameterName[1];
                }
            }
        }

// dateTime 
	function pad(s) {
		var len = (String(10).length - String(s).length)+1;
		return len > 0? new Array(len).join('0')+s : s;
	}

        var ip = getUrlParameter("ip");

        $.ajax({url: "/api/counters/"+ip, success: function(result){
            console.log("/api/counters/" + ip);
            console.log(result);
            var interfaces = result;
            $("#ip_span").text(ip + ":");
            $("#tbl_data tbody tr").empty();
            interfaces.forEach(function(entry) {
		var d = new Date(parseInt(entry.pollTime));
                var row = "<tr>" + 
                          "<td>" + entry.ifDescr + "</td>" + 
                          "<td>" + entry.ifInOctets.value + "</td>" + 
                          "<td>" + entry.ifOutOctets.value + "</td>" + 
                          "<td>" +
			    [pad(d.getDate()),pad(d.getMonth()+1),d.getFullYear()].join('-')+' '+ 
			    [pad(d.getHours()), pad(d.getMinutes()),pad(d.getSeconds())].join(':')+
			  "</td>" + 
                          "<td>" + entry.sysUpTime + "</td>" + 
                          "</tr>";
                $("#tbl_data tbody").append(row);
            });
        }});
    </script>
  </body>
</html>
